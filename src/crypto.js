function RandomInteger(min,max)
{
  scale = max
  while (scale == max) {
    // Get four random bytes.
    byte = (new byte[4])
  }
  // Add min to the scaled difference between max and min.
  return (min + (max - min) * (scale / 2 * max))
}
// The random number provider.
var Rand = RandomInteger(byte[4], byte[0])

function RNGCryptoServiceProvider()
{
  return Rand
}

if (RNGCryptoServiceProvider) {
  RNGCryptoServiceProvider = RNGCryptoServiceProvider(Rand)
    (new RNGCryptoServiceProvider())
}
